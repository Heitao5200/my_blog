# Task5 推荐系统流程构建

## 基本流程

1. Offline：使用离线物料画像和用户画像，生成当前最新的用户推荐列表，热门列表，及冷启动内容。
2. Online：根据不同用户组，生成用户推荐列表，热门列表，Redis过滤排序保存，展示在前端。

## Offline

### 热门页列表创建

1. 遍历物料池里面的所有文章。

2. 计算时间差,保证最近3天的内容。

3. 计算热度分。

   ```
   news_hot_value = (news_likes_num * 6 + news_collections_num * 3 + news_read_num * 1) * 10 / (time_hour_diff+1)**1.2
   ```

4. 更新物料池的文章hot_value,保存到redis中。

### 推荐页列表创建

冷启动

1. 根据年龄，性别(用户注册时会获取到)进行用户分组。
2. 将确定分组后的用户的物料添加到redis中，并记录当前用户的所有新闻类别id。
3. 将每个用户涉及到的不同的新闻列表添加到redis中去。
4. 更新物料库中所有新闻的热度值，根据文章的热度信息，给新用户生成一份冷启动推荐列表。

个性化推荐

1. 目前该系统没有提供千人千面的推荐功能。

## Online

### 热门页列表创建

1. 判断新老用户。
2. 新用户从离线存储好的公共冷启动模板中为该用户生成一份热门页新闻列表。
3. 老用户从离线存储好的该用户热门列表中读取新闻列表。
4. 选择指定数目文章推荐曝光，生成最终推荐列表，更新曝光记录。

### 推荐页列表创建

1. 判断新老用户。
2. 新用户从离线存储好的冷启动列表中读取推荐列表 。
3. 老用户离线存储好的该用户热门列表中读取，选择指定数目文章推荐。
4. 选择指定数目文章推荐，去曝光，生成最终推荐列表，更新曝光记录。